# Example Terraform variables for production environment
# Copy this file to terraform.tfvars and update the values

# Project Configuration
project_name = "pipeops"
environment  = "prod"
region      = "us-west-2"

# Network Configuration
vpc_cidr              = "10.0.0.0/16"
availability_zones    = ["us-west-2a", "us-west-2b", "us-west-2c"]
private_subnet_cidrs  = ["10.0.1.0/24", "10.0.2.0/24", "10.0.3.0/24"]
public_subnet_cidrs   = ["10.0.101.0/24", "10.0.102.0/24", "10.0.103.0/24"]
database_subnet_cidrs = ["10.0.201.0/24", "10.0.202.0/24", "10.0.203.0/24"]

# EKS Configuration
kubernetes_version = "1.33"
create_eks         = true   # Set false to skip EKS cluster and all EKS-dependent resources
create_rds         = true   # Set false to skip RDS and DB-related resources

# RDS Configuration
db_instance_class              = "db.r6g.large"
db_allocated_storage           = 100
db_backup_retention            = 30
db_multi_az                    = true    # Enable Multi-AZ for HA (recommended for prod)
db_create_read_replica         = false   # Enable read replicas for read-heavy workloads
db_read_replica_count          = 1       # Number of read replicas
db_read_replica_instance_class = "db.r6g.large"
db_replica_availability_zones  = ["us-west-2b", "us-west-2c"]  # AZs for replicas
db_iops                        = 3000    # Provisioned IOPS for better performance (optional)
db_monitoring_sns_topic_arn    = ""      # SNS topic for RDS alarms (create one first)
db_apply_immediately           = false   # Apply changes during maintenance window

# Multi-Region Disaster Recovery (Optional - adds significant cost)
dr_region                      = "us-east-1"  # DR region (must be different from primary)
db_enable_cross_region_dr      = false   # Enable DR replica in another region
db_dr_instance_class           = "db.r6g.large"  # DR instance size
db_dr_multi_az                 = true    # Multi-AZ in DR region (recommended)
db_enable_cross_region_backups = false   # Enable backup replication to DR region

# DR EKS Cluster Configuration (Production Only - automatically enabled for prod environment)
# These settings are only used when environment = "prod"
dr_vpc_cidr                             = "10.1.0.0/16"
dr_availability_zones                   = ["us-east-1a", "us-east-1b", "us-east-1c"]
dr_public_subnet_cidrs                  = ["10.1.101.0/24", "10.1.102.0/24", "10.1.103.0/24"]
dr_private_subnet_cidrs                 = ["10.1.1.0/24", "10.1.2.0/24", "10.1.3.0/24"]
dr_database_subnet_cidrs                = ["10.1.201.0/24", "10.1.202.0/24", "10.1.203.0/24"]
dr_cluster_endpoint_public_access_cidrs = ["0.0.0.0/0"]  # Restrict to your IP ranges in production
dr_desired_capacity                     = 2              # Minimal nodes for standby mode
dr_min_capacity                         = 2
dr_max_capacity                         = 6              # Can scale during DR activation
dr_node_instance_types                  = ["t3.medium", "t3.large"]  # Cost-optimized

# ECR Repositories
ecr_repository_names = [
  "api",
  "frontend",
  "backend",
  "worker"
]
ecr_scan_on_push                   = true   # Scan images for vulnerabilities
ecr_lifecycle_keep_count           = 30     # Keep last 30 images
ecr_lifecycle_expire_untagged_days = 14     # Expire untagged images after 14 days
ecr_enable_replication             = true   # Enable cross-region replication (prod only)
ecr_replication_regions            = ["us-east-1"]  # DR region

# Feature Flags
enable_argocd        = true
enable_monitoring    = true
enable_metrics_server = true  # Helm-based metrics-server for HPA, kubectl top, Karpenter
enable_logging       = true

# Tags
tags = {
  Project     = "pipeops"
  Environment = "prod"
  ManagedBy   = "terraform"
  GitOps      = "argocd"
  CostCenter  = "engineering"
  Owner       = "platform-team"
}